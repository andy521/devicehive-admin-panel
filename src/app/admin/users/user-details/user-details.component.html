<div class="container" *ngIf="user">
  <dh-user [user]="user"></dh-user>

  <button class="btn btn-success" (click)="updateUser()">Save</button>

  <ngb-tabset>
    <ngb-tab title="Networks">
      <ng-template ngbTabContent>
        <table class="table">
          <thead class="thead-light">
            <tr>
              <th scope="col">Network</th>
              <th scope="col">Description</th>
              <th scope="col"></th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let network of user.networks">
              <td>{{network.name}}</td>
              <td>{{network.description}}</td>
              <td>
                <button class="btn btn-danger btn-sm" (click)="revokeAccessToNetwork(network)">Revoke access</button>
              </td>
            </tr>
          </tbody>
        </table>

        <form class="form-inline">
          <label class="mr-2" for="inputNetwork">Grant access to another network</label>
          <select id="inputNetwork" class="form-control mb-2 mr-sm-2" name="network" [(ngModel)]="selectedNetwork">
            <option *ngFor="let network of allNetworks" [ngValue]="network">{{network.name}}</option>
          </select>

          <button class="btn btn-primary mb-2" (click)="grantAccessToNetwork()">Grant access</button>
        </form>

      </ng-template>
    </ngb-tab>

    <ngb-tab title="Device Types">
      <ng-template ngbTabContent>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="allDeviceTypeCheck"
                 [(ngModel)]="user.allDeviceTypesAvailable" (ngModelChange)="toggleAllowAllDeviceTypes()">
          <label class="form-check-label" for="allDeviceTypeCheck">All device types are available to user</label>
        </div>

        <table class="table" *ngIf="!user.allDeviceTypesAvailable">
          <thead class="thead-light">
            <tr>
              <th scope="col">Device Type</th>
              <th scope="col">Description</th>
              <th scope="col"></th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let deviceType of userDeviceTypes">
              <td>{{deviceType.name}}</td>
              <td>{{deviceType.description}}</td>
              <td>
                <button class="btn btn-danger btn-sm" (click)="revokeAccessToDeviceType(deviceType)">Revoke access</button>
              </td>
            </tr>
          </tbody>
        </table>

        <form class="form-inline" *ngIf="!user.allDeviceTypesAvailable">
          <label class="mr-2" for="inputDeviceType">Grant access to another device type</label>
          <select id="inputDeviceType" class="form-control mb-2 mr-sm-2" name="deviceType" [(ngModel)]="selectedDeviceType">
            <option *ngFor="let deviceType of allDeviceTypes" [ngValue]="deviceType">{{deviceType.name}}</option>
          </select>

          <button class="btn btn-primary mb-2" (click)="grantAccessToDeviceType()">Grant access</button>
        </form>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>
</div>
